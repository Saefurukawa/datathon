# -*- coding: utf-8 -*-
"""dataset-cleaning.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1040vlFeH7I5ym-dExt9sOifWRveFgzVW
"""

!pip install category_encoders

import pandas as pd
import numpy as np
import category_encoders as ce
from sklearn.decomposition import PCA

dataset = pd.read_csv("datathon_train.csv")

def get_time(string):
  return int(string[:2])
dataset['DEP_TIME'] = dataset['DEP_TIME_BLK'].apply(get_time)

dataset_clean = dataset.drop(['Id', 'ORIGIN_CITY_NAME', 'DEST_CITY_NAME', 'DEP_TIME_BLK'], axis = 1)

cols = ['PREVIOUS_AIRPORT', 'DEST', 'CARRIER_NAME', 'DEPARTING_AIRPORT']
encoder = ce.BinaryEncoder(cols=cols)
dataset_encoded = encoder.fit_transform(dataset_clean)
dataset_encoded = dataset_encoded.dropna()



X_df = dataset_encoded.drop(['DEP_DELAY_NEW', 'IS_DELAYED'], axis = 1)
X = X_df.to_numpy()

y = dataset_encoded['IS_DELAYED'].to_numpy()

X_pca = PCA().fit_transform(X)

NUM_SELECTED_COLUMNS = 7
selected_columns = X_pca[:,:NUM_SELECTED_COLUMNS]